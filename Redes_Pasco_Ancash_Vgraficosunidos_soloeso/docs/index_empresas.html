<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<title>Proyección sobre empresas — consorcios</title>
<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;padding:20px;background:#f5f5f5;}
.container{max-width:1200px;margin:0 auto;}
h2{margin-top:0;margin-bottom:10px;}
iframe{width:100%;height:80vh;border:1px solid #ddd;border-radius:8px;background:#fff;}
.bar{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-bottom:15px;}
select,button{padding:6px 10px;border-radius:6px;border:1px solid #ccc;background:#fff;cursor:pointer;}
button:hover{background:#f0f0f0;}
.kpi{background:#fff;border:1px solid #ddd;padding:6px 12px;border-radius:8px;}
</style>
</head>
<body>
<div class="container">
  <h2>Proyección sobre empresas — Consorcios por periodo</h2>
  <div class="bar">
    <button onclick="prev()">⟨ Anterior</button>
    <label for="period_emp">Periodo:</label>
    <select id="period_emp" onchange="go(this.value)"></select>
    <button onclick="next()">Siguiente ⟩</button>
    <span class="kpi" id="kpi_emp"></span>
  </div>
  <iframe id="view_emp" src="" loading="lazy"></iframe>
</div>
<script>
const items = [{"p": "2003-2006", "f": "empresas_consorcios_2003-2006.html", "density": 0.09166666666666666, "n_empresas": 16, "n_aristas": 11, "n_consortios": 8, "avg_degree": 1.375, "avg_clustering": 0.1875}, {"p": "2007-2010", "f": "empresas_consorcios_2007-2010.html", "density": 0.00894033502729155, "n_empresas": 253, "n_aristas": 285, "n_consortios": 109, "avg_degree": 2.2529644268774702, "avg_clustering": 0.28554522697446355}, {"p": "2011-2014", "f": "empresas_consorcios_2011-2014.html", "density": 0.006947826966023656, "n_empresas": 467, "n_aristas": 756, "n_consortios": 219, "avg_degree": 3.2376873661670236, "avg_clustering": 0.23129803904907675}, {"p": "2015-2018", "f": "empresas_consorcios_2015-2018.html", "density": 0.006905017646156207, "n_empresas": 343, "n_aristas": 405, "n_consortios": 166, "avg_degree": 2.361516034985423, "avg_clustering": 0.3026912300863559}, {"p": "2019-2022", "f": "empresas_consorcios_2019-2022.html", "density": 0.0036290964047088767, "n_empresas": 449, "n_aristas": 365, "n_consortios": 281, "avg_degree": 1.6258351893095768, "avg_clustering": 0.08112071357453975}, {"p": "2023-2026", "f": "empresas_consorcios_2023-2026.html", "density": 0.012618908949718502, "n_empresas": 102, "n_aristas": 65, "n_consortios": 54, "avg_degree": 1.2745098039215685, "avg_clustering": 0.0718954248366013}];
let idx = 0;

function fillSelect(){
  const sel = document.getElementById("period_emp");
  sel.innerHTML = "";
  items.forEach((it,i)=>{
    const o = document.createElement("option");
    o.value = i;
    o.textContent = it.p;
    sel.appendChild(o);
  });
}

function updateKPI(){
  const it = items[idx];
  const dens = (it.density !== null && !isNaN(it.density)) ? it.density.toFixed(4) : "—";
  document.getElementById("kpi_emp").innerHTML =
    "<b>Densidad:</b> "+dens+
    " | <b>Empresas:</b> "+it.n_empresas+
    " | <b>Aristas (pares de empresas):</b> "+it.n_aristas+
    " | <b>Contratos en consorcio:</b> "+it.n_consortios;
}

function load(){
  if(!items.length) return;
  const it = items[idx];
  document.getElementById("view_emp").src = it.f;
  document.getElementById("period_emp").selectedIndex = idx;
  updateKPI();
}

function go(i){ idx = parseInt(i); load(); }
function prev(){ idx = (idx - 1 + items.length) % items.length; load(); }
function next(){ idx = (idx + 1) % items.length; load(); }

fillSelect();
load();
</script>
</body>
</html>
