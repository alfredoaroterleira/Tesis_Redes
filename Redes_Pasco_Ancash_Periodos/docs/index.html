<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<title>Redes de contratación por periodo</title>
<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;padding:20px;background:#f5f5f5;}
.container{max-width:1200px;margin:0 auto;}
h2{margin-top:0;margin-bottom:10px;}
iframe{width:100%;height:80vh;border:1px solid #ddd;border-radius:8px;background:#fff;}
.bar{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-bottom:15px;}
select,button{padding:6px 10px;border-radius:6px;border:1px solid #ccc;background:#fff;cursor:pointer;}
button:hover{background:#f0f0f0;}
.kpi{background:#fff;border:1px solid #ddd;padding:6px 12px;border-radius:6px;}
</style>
</head>
<body>
<div class="container">
  <h2>Redes de contratación — Periodos de gobierno (bipartito regiones–empresas)</h2>
  <div class="bar">
    <button onclick="prev()">⟨ Anterior</button>
    <label for="period">Periodo:</label>
    <select id="period" onchange="go(this.value)"></select>
    <button onclick="next()">Siguiente ⟩</button>
    <span class="kpi" id="kpi"></span>
  </div>
  <iframe id="view" src="" loading="lazy"></iframe>
</div>
<script>
const items = [{"p": "2003-2006", "f": "red_2003-2006.html", "density": 0.03123399897593446, "n_regiones": 2, "n_empresas": 61, "n_contratos": 79}, {"p": "2007-2010", "f": "red_2007-2010.html", "density": 0.006688963210702341, "n_regiones": 2, "n_empresas": 298, "n_contratos": 351}, {"p": "2011-2014", "f": "red_2011-2014.html", "density": 0.004115020241225324, "n_regiones": 2, "n_empresas": 488, "n_contratos": 689}, {"p": "2015-2018", "f": "red_2015-2018.html", "density": 0.005713376303015835, "n_regiones": 2, "n_empresas": 353, "n_contratos": 463}, {"p": "2019-2022", "f": "red_2019-2022.html", "density": 0.004209763545863131, "n_regiones": 2, "n_empresas": 480, "n_contratos": 666}, {"p": "2023-2026", "f": "red_2023-2026.html", "density": 0.019044062733383122, "n_regiones": 2, "n_empresas": 102, "n_contratos": 116}];
let idx = 0;

function fillSelect(){
  const sel = document.getElementById("period");
  sel.innerHTML = "";
  items.forEach((it,i)=>{
    const o = document.createElement("option");
    o.value = i;
    o.textContent = it.p;
    sel.appendChild(o);
  });
}

function updateKPI(){
  const it = items[idx];
  const dens = (it.density !== null && !isNaN(it.density)) ? it.density.toFixed(4) : "—";
  document.getElementById("kpi").innerHTML =
    "<b>Densidad:</b> "+dens+
    " | <b>Regiones:</b> "+it.n_regiones+
    " | <b>Empresas:</b> "+it.n_empresas+
    " | <b>Contratos:</b> "+it.n_contratos;
}

function load(){
  if(!items.length) return;
  const it = items[idx];
  document.getElementById("view").src = it.f;
  document.getElementById("period").selectedIndex = idx;
  updateKPI();
}

function go(i){ idx = parseInt(i); load(); }
function prev(){ idx = (idx - 1 + items.length) % items.length; load(); }
function next(){ idx = (idx + 1) % items.length; load(); }

fillSelect();
load();
</script>
</body>
</html>
