<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Redes de contratación - Ancash (HHI por contratos)</title>
<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;padding:18px;background:#fafafa}
.container{max-width:1200px;margin:0 auto}
h1{font-size:20px;margin:0 0 14px}
.bar{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-bottom:12px}
label,select,button,small,span{font-size:14px}
iframe{width:100%;height:78vh;border:1px solid #e3e3e3;border-radius:10px;background:#fff}
button{padding:6px 10px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer}
button:hover{background:#f2f2f2}
.kpi{background:#fff;border:1px solid #e7e7e7;border-radius:8px;padding:6px 10px}
.kpi b{font-weight:600}
small{color:#666}
</style>
</head>
<body>
<div class="container">
  <h1>Redes de contratación • Ancash (HHI por contratos)</h1>
  <div class="bar">
    <button onclick="prev()">⟨ Anterior</button>
    <label for="year">Año:</label>
    <select id="year" onchange="go(this.value)"></select>
    <button onclick="next()">Siguiente ⟩</button>
    <span class="kpi" id="kpi">—</span>
    <small>Grosor y tamaño = # de contratos; tooltip muestra #contratos y monto total.</small>
  </div>
  <iframe id="view" src="" loading="lazy"></iframe>
</div>
<script>
const items = [{"y": 2005, "f": "ancash_2005.html", "hhi": 0.041666666666666664, "emp": 24, "contr": 24}, {"y": 2006, "f": "ancash_2006.html", "hhi": 0.05029585798816569, "emp": 23, "contr": 26}, {"y": 2007, "f": "ancash_2007.html", "hhi": 0.049586776859504134, "emp": 21, "contr": 22}, {"y": 2008, "f": "ancash_2008.html", "hhi": 0.04010519395134779, "emp": 30, "contr": 39}, {"y": 2009, "f": "ancash_2009.html", "hhi": 0.017709563164108613, "emp": 69, "contr": 77}, {"y": 2010, "f": "ancash_2010.html", "hhi": 0.012957861442709934, "emp": 87, "contr": 99}, {"y": 2011, "f": "ancash_2011.html", "hhi": 0.008785836966574185, "emp": 140, "contr": 174}, {"y": 2012, "f": "ancash_2012.html", "hhi": 0.013025744484891012, "emp": 109, "contr": 151}, {"y": 2013, "f": "ancash_2013.html", "hhi": 0.049586776859504134, "emp": 21, "contr": 22}, {"y": 2014, "f": "ancash_2014.html", "hhi": 0.024005486968449924, "emp": 47, "contr": 54}, {"y": 2015, "f": "ancash_2015.html", "hhi": 0.07692307692307694, "emp": 13, "contr": 13}, {"y": 2016, "f": "ancash_2016.html", "hhi": 0.05785123966942149, "emp": 19, "contr": 22}, {"y": 2017, "f": "ancash_2017.html", "hhi": 0.007677172948574514, "emp": 143, "contr": 161}, {"y": 2018, "f": "ancash_2018.html", "hhi": 0.010688000000000001, "emp": 109, "contr": 125}, {"y": 2019, "f": "ancash_2019.html", "hhi": 0.017906336088154277, "emp": 61, "contr": 66}, {"y": 2020, "f": "ancash_2020.html", "hhi": 0.013374485596707819, "emp": 90, "contr": 108}, {"y": 2021, "f": "ancash_2021.html", "hhi": 0.01329060231878593, "emp": 86, "contr": 103}, {"y": 2022, "f": "ancash_2022.html", "hhi": 0.008093859062894481, "emp": 155, "contr": 201}, {"y": 2023, "f": "ancash_2023.html", "hhi": 0.25, "emp": 4, "contr": 4}, {"y": 2024, "f": "ancash_2024.html", "hhi": 0.20000000000000004, "emp": 5, "contr": 5}];
let idx = 0;

function fillSelect() {
  const sel = document.getElementById('year');
  sel.innerHTML = "";
  items.forEach((it, i) => {
    const o = document.createElement('option');
    o.value = i;
    o.textContent = it.y;
    sel.appendChild(o);
  });
}

function updateKPI() {
  const it = items[idx];
  const hhi = (it.hhi !== null && !isNaN(it.hhi)) ? Number(it.hhi).toFixed(3) : "—";
  document.getElementById('kpi').innerHTML = `<b>HHI (contratos):</b> ${hhi} | <b>Empresas:</b> ${it.emp} | <b>Contratos:</b> ${it.contr}`;
}

function load() {
  if (!items.length) return;
  const it = items[idx];
  document.getElementById('view').src = it.f;
  document.getElementById('year').selectedIndex = idx;
  updateKPI();
}

function go(i) { idx = parseInt(i); load(); }
function prev() { idx = (idx - 1 + items.length) % items.length; load(); }
function next() { idx = (idx + 1) % items.length; load(); }

fillSelect();
load();
</script>
</body>
</html>